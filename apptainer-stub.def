Bootstrap: docker
From: nvidia/cuda:12.1.1-devel-ubuntu22.04

%files
# Copy the Triton source code to the image
requirements.txt /home/tritonuser/requirements.txt
packages.txt /home/tritonuser/packages.txt


%post
# Use NVIDIA CUDA base image with Ubuntu 22.04

# Set environment variables
DEBIAN_FRONTEND=noninteractive
CMAKE_GENERATOR=Ninja

find /var/lib/apt/lists -type f  |xargs rm -f >/dev/null

# install apt dependencies specified in packages.txt
apt-get update && apt-get install -y $(cat /home/tritonuser/packages.txt)


pip install -r /home/tritonuser/requirements.txt

# Set the default command
%environment
export DEBIAN_FRONTEND=noninteractive
export CMAKE_GENERATOR=Ninja
%runscript
exec /bin/bash exec /bin/bash "$@"
%startscript
exec /bin/bash exec /bin/bash "$@"
